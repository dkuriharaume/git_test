Entirely rewritten over by dkurihara3352
